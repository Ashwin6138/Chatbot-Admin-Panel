<div class="dashboard-container">

<app-nav></app-nav>

<!-- Main Content -->
<div class="main-content">
  <div class="container">
    <!-- Single White Card Wrapper -->
    <div class="white-card-wrapper">
      
      <!-- Feature Tabs -->
      <div class="features-tabs">
        <div class="feature-item" routerLink="/upload" routerLinkActive="feature-active">
          <img src="assets/images/tabler_upload.png" alt="Upload" class="feature-icon">
          <span>Upload Document</span>
        </div>
        
        <div class="feature-item" routerLink="/knowledge" routerLinkActive="feature-active">
          <img src="assets/images/hugeicons_knowledge-01.png" alt="Knowledge Base" class="feature-icon">
          <span>Knowledge Base Reset</span>
        </div>
        
        <div class="feature-item" routerLink="/stats" routerLinkActive="feature-active">
          <img src="assets/images/nimbus_stats.png" alt="Stats" class="feature-icon">
          <span>Daily Stats</span>
        </div>
      </div>

      <!-- Grey Inner Card for Knowledge Base Content -->
      <div class="grey-inner-card">
        <h2 class="upload-title">KNOWLEDGE BASE RESET</h2>

        <div class="kb-content-wrapper">
          <!-- Reset Knowledge Base Section -->
          <div class="kb-section reset-section">
            <div class="kb-section-header">
              <div class="kb-icon-wrapper warning">
                <img src="assets/images/Group 64.png" alt="Warning" class="kb-icon" width="20" height="20">
              </div>
              <div class="kb-section-content">
                <h3 class="kb-section-title">Reset Knowledge Base</h3>
                <p class="kb-section-desc">This will completely reset the knowledge base. You must upload a new folder after resetting.</p>
                <button 
                  class="reset-btn" 
                  [disabled]="isResetting"
                  (click)="handleReset()">
                  <img *ngIf="!isResetting" src="assets/images/tabler_refresh.png" alt="Reset" width="18" height="18">
                  <span *ngIf="isResetting">Resetting...</span>
                  <span *ngIf="!isResetting">Reset Knowledge Base</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Full KB Re-Ingest Section -->
          <div class="kb-section reingest-section" [class.disabled]="!isResetClicked">
            <div class="kb-section-header">
              <div class="kb-icon-wrapper">
                <img src="assets/images/upload icon.png" alt="Upload" class="kb-icon" width="20" height="20">
              </div>
              <div class="kb-section-content">
                <h3 class="kb-section-title">Full KB Re-Ingest</h3>
                <p class="kb-section-desc">
                  <span *ngIf="!isResetClicked">Upload a ZIP file containing all documents to rebuild the knowledge base (Reset required first)</span>
                  <span *ngIf="isResetClicked">Upload a ZIP file containing all documents to rebuild the knowledge base</span>
                </p>
              </div>
            </div>
            
            <div class="folder-upload-area">
              <div class="upload-icon-wrapper">
                <img src="assets/images/full kb upload.png" alt="Upload" class="upload-icon" width="40" height="40">
              </div>
              <p class="folder-upload-text">Select a ZIP file to upload</p>
              <p class="folder-upload-subtext" *ngIf="!isResetClicked">Please reset the knowledge base first</p>
              <p class="folder-upload-subtext" *ngIf="isResetClicked">Choose a ZIP file containing your documents</p>
              
              <input 
                type="file" 
                id="folderInput"
                class="file-input"
                accept=".zip"
                multiple
                [disabled]="!canUpload"
                (change)="handleFolderSelect($event)">
              
              <button 
                type="button" 
                class="browse-folder-btn" 
                [disabled]="!canUpload"
                (click)="triggerFolderInput()">
                Browse ZIP file
              </button>

              <p *ngIf="selectedFolder && selectedFolder.length > 0" class="selected-file">
                âœ“ Selected: {{ selectedFolder.length }} file{{ selectedFolder.length !== 1 ? 's' : '' }}
              </p>
            </div>

            <button 
              class="upload-reingest-btn" 
              [disabled]="!canSubmitUpload"
              (click)="handleUploadAndReingest()">
              <img *ngIf="!isUploading" src="assets/images/tabler_upload (1).png" alt="Upload" width="18" height="18">
              <span *ngIf="isUploading">Uploading...</span>
              <span *ngIf="!isUploading">Upload & Re-Ingest</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      Powered by BYT strategy group
    </div>
  </div>
</div>

</div>