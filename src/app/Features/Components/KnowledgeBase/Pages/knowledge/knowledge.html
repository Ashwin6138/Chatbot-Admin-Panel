<div class="dashboard-container">

<app-nav></app-nav>

<!-- Main Content -->
<div class="main-content">
  <div class="container">
    <!-- Single White Card Wrapper -->
    <div class="white-card-wrapper">
      
      <!-- Feature Tabs -->
      <div class="features-tabs">
        <div class="feature-item" routerLink="/upload" routerLinkActive="feature-active">
          <img src="assets/images/tabler_upload.png" alt="Upload" class="feature-icon">
          <span>Upload Document</span>
        </div>
        
        <div class="feature-item" routerLink="/knowledge" routerLinkActive="feature-active">
          <img src="assets/images/hugeicons_knowledge-01.png" alt="Knowledge Base" class="feature-icon">
          <span>Knowledge Base Reset</span>
        </div>
        
        <div class="feature-item" routerLink="/stats" routerLinkActive="feature-active">
          <img src="assets/images/nimbus_stats.png" alt="Stats" class="feature-icon">
          <span>Daily Stats</span>
        </div>
      </div>

      <!-- Grey Inner Card for Knowledge Base Content -->
      <div class="grey-inner-card">
        <h2 class="upload-title">KNOWLEDGE BASE RESET</h2>

        <div class="kb-content-wrapper">
          <!-- Reset Knowledge Base Section -->
          <div class="kb-section reset-section">
            <div class="kb-section-header">
              <div class="kb-icon-wrapper warning">
                <svg class="kb-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                  <line x1="12" y1="9" x2="12" y2="13"></line>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
              </div>
              <div class="kb-section-content">
                <h3 class="kb-section-title">Reset Knowledge Base</h3>
                <p class="kb-section-desc">This will completely reset the knowledge base. You must upload a new folder after resetting.</p>
                <button 
                  class="reset-btn" 
                  [disabled]="isResetting"
                  (click)="handleReset()">
                  <svg *ngIf="!isResetting" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="1 4 1 10 7 10"></polyline>
                    <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
                  </svg>
                  <span *ngIf="isResetting">Resetting...</span>
                  <span *ngIf="!isResetting">Reset Knowledge Base</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Full KB Re-Ingest Section -->
          <div class="kb-section reingest-section" [class.disabled]="!isResetClicked">
            <div class="kb-section-header">
              <div class="kb-icon-wrapper">
                <svg class="kb-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="17 8 12 3 7 8"></polyline>
                  <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
              </div>
              <div class="kb-section-content">
                <h3 class="kb-section-title">Full KB Re-Ingest</h3>
                <p class="kb-section-desc">
                  <span *ngIf="!isResetClicked">Upload a ZIP file containing all documents to rebuild the knowledge base (Reset required first)</span>
                  <span *ngIf="isResetClicked">Upload a ZIP file containing all documents to rebuild the knowledge base</span>
                </p>
              </div>
            </div>
            
            <div class="folder-upload-area">
              <div class="upload-icon-wrapper">
                <svg class="upload-icon" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="17 8 12 3 7 8"></polyline>
                  <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
              </div>
              <p class="folder-upload-text">Select a ZIP file to upload</p>
              <p class="folder-upload-subtext" *ngIf="!isResetClicked">Please reset the knowledge base first</p>
              <p class="folder-upload-subtext" *ngIf="isResetClicked">Choose a ZIP file containing your documents</p>
              
              <input 
                type="file" 
                id="folderInput"
                class="file-input"
                accept=".zip"
                multiple
                [disabled]="!canUpload"
                (change)="handleFolderSelect($event)">
              
              <button 
                type="button" 
                class="browse-folder-btn" 
                [disabled]="!canUpload"
                (click)="triggerFolderInput()">
                Browse ZIP file
              </button>

              <p *ngIf="selectedFolder && selectedFolder.length > 0" class="selected-file">
                âœ“ Selected: {{ selectedFolder.length }} file{{ selectedFolder.length !== 1 ? 's' : '' }}
              </p>
            </div>

            <button 
              class="upload-reingest-btn" 
              [disabled]="!canSubmitUpload"
              (click)="handleUploadAndReingest()">
              <svg *ngIf="!isUploading" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
              </svg>
              <span *ngIf="isUploading">Uploading...</span>
              <span *ngIf="!isUploading">Upload & Re-Ingest</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      Powered by BYT strategy group
    </div>
  </div>
</div>

</div>